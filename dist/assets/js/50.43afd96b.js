(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{377:function(s,t,a){"use strict";a.r(t);var e=a(10),r=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"mysql添加联合索引"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mysql添加联合索引"}},[s._v("#")]),s._v(" MySQL添加联合索引")]),s._v(" "),t("p",[s._v("在 MySQL 中，联合索引（Composite Index）是指在多个列上创建的索引。联合索引可以提高多列查询的性能，特别是在涉及到多个列的 WHERE 子句或 JOIN 操作时。")]),s._v(" "),t("p",[s._v("下面是如何在 MySQL 中创建联合索引的步骤和示例。")]),s._v(" "),t("h3",{attrs:{id:"创建联合索引"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建联合索引"}},[s._v("#")]),s._v(" 创建联合索引")]),s._v(" "),t("p",[s._v("假设有一个表 "),t("code",[s._v("atwol_error_history")]),s._v("，你想要在 "),t("code",[s._v("dfv_value")]),s._v(" 和 "),t("code",[s._v("vehicle_id")]),s._v(" 两列上创建联合索引。")]),s._v(" "),t("h4",{attrs:{id:"创建表和添加数据-示例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建表和添加数据-示例"}},[s._v("#")]),s._v(" 创建表和添加数据（示例）")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" atwol_error_history "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n  dfv_value "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("255")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DEFAULT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COMMENT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'故障报错的值'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  dfc_name "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("255")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DEFAULT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COMMENT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'故障名称'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  vehicle_id "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("255")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DEFAULT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COMMENT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'车辆id'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  atwol_error_id "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VARCHAR")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("255")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DEFAULT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COMMENT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'atwol_error表ID'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  start_time "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DATETIME")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DEFAULT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COMMENT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'开始时间'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  end_time "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DATETIME")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DEFAULT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COMMENT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'结束时间'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  show_time "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DATETIME")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DEFAULT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COMMENT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'生效时间'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  is_new "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DEFAULT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COMMENT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'是否为最新配置(0.否；1.是)'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  is_show "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DEFAULT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COMMENT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'是否生效(0.未生效; 1.已生效)'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("PRIMARY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("dfv_value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" vehicle_id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("-- 假设联合主键")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ENGINE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("InnoDB")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DEFAULT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CHARSET")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COMMENT")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'错误信息对应历史记录表'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h4",{attrs:{id:"创建联合索引-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建联合索引-2"}},[s._v("#")]),s._v(" 创建联合索引")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" idx_dfv_vehicle "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" atwol_error_history "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("dfv_value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" vehicle_id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h3",{attrs:{id:"使用联合索引的查询示例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用联合索引的查询示例"}},[s._v("#")]),s._v(" 使用联合索引的查询示例")]),s._v(" "),t("p",[s._v("当你有一个查询需要在 "),t("code",[s._v("dfv_value")]),s._v(" 和 "),t("code",[s._v("vehicle_id")]),s._v(" 上进行过滤时，联合索引将提高查询性能。")]),s._v(" "),t("h4",{attrs:{id:"查询示例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查询示例"}},[s._v("#")]),s._v(" 查询示例")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" atwol_error_history\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" dfv_value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'some_value'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("AND")]),s._v(" vehicle_id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'some_vehicle_id'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h3",{attrs:{id:"联合索引的使用规则"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#联合索引的使用规则"}},[s._v("#")]),s._v(" 联合索引的使用规则")]),s._v(" "),t("ol",[t("li",[t("strong",[s._v("最左前缀原则")]),s._v("：联合索引可以用于查询中包含的所有列，或者最左侧的几列。例如，索引 "),t("code",[s._v("(dfv_value, vehicle_id)")]),s._v(" 可以用于 "),t("code",[s._v("dfv_value")]),s._v(" 或 "),t("code",[s._v("(dfv_value, vehicle_id)")]),s._v(" 的查询，但是不能单独用于 "),t("code",[s._v("vehicle_id")]),s._v(" 的查询。")]),s._v(" "),t("li",[t("strong",[s._v("覆盖索引")]),s._v("：如果索引包含了查询需要的所有列，查询可以直接从索引中获取数据，而不需要回表查询。")])]),s._v(" "),t("h3",{attrs:{id:"删除联合索引"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除联合索引"}},[s._v("#")]),s._v(" 删除联合索引")]),s._v(" "),t("p",[s._v("如果你需要删除已创建的联合索引，可以使用以下命令：")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" idx_dfv_vehicle "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" atwol_error_history"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("h3",{attrs:{id:"实践中的优化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#实践中的优化"}},[s._v("#")]),s._v(" 实践中的优化")]),s._v(" "),t("p",[s._v("创建联合索引时需要考虑查询模式，以确保索引能够有效地提高性能。在创建索引前，可以使用 "),t("code",[s._v("EXPLAIN")]),s._v(" 命令来分析查询的执行计划，判断是否需要联合索引。")]),s._v(" "),t("h4",{attrs:{id:"使用-explain-分析查询"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用-explain-分析查询"}},[s._v("#")]),s._v(" 使用 EXPLAIN 分析查询")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPLAIN")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" atwol_error_history\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" dfv_value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'some_value'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("AND")]),s._v(" vehicle_id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'some_vehicle_id'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("通过 "),t("code",[s._v("EXPLAIN")]),s._v(" 的输出，可以看到查询是否使用了索引，以及索引的使用情况，从而决定是否需要创建或调整联合索引。")]),s._v(" "),t("h3",{attrs:{id:"例子-结合联合索引的优化查询"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#例子-结合联合索引的优化查询"}},[s._v("#")]),s._v(" 例子：结合联合索引的优化查询")]),s._v(" "),t("p",[s._v("基于你前面的查询需求，假设你希望在 "),t("code",[s._v("breakdown")]),s._v(" 表的 "),t("code",[s._v("dfc_value")]),s._v(" 和 "),t("code",[s._v("vehicle_id")]),s._v(" 列上创建联合索引，以优化 JOIN 操作，可以这样做：")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" idx_dfc_vehicle "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" breakdown "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("dfc_value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" vehicle_id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("这样，当你在 "),t("code",[s._v("breakdown")]),s._v(" 表上进行类似以下的查询时，索引会提高查询性能：")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" breakdown\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LEFT")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("JOIN")]),s._v(" atwol_error_history \n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" breakdown"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("dfc_value "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" atwol_error_history"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("dfv_value \n "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("AND")]),s._v(" breakdown"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("vehicle_id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" atwol_error_history"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("vehicle_id\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("AND")]),s._v(" atwol_error_history"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("is_show "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("AND")]),s._v(" breakdown"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("version_date "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("BETWEEN")]),s._v(" atwol_error_history"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("start_time "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("AND")]),s._v(" IFNULL"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("atwol_error_history"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("end_time"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("NOW")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),t("p",[s._v("通过这些步骤和示例，你可以有效地创建和使用联合索引来优化 MySQL 查询性能。")])])}),[],!1,null,null,null);t.default=r.exports}}]);